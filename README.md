レポジトリ
======================

レポジトリパターン
------------

レポジトリーパターンとは、アプリの他の部分からデータソースを切り離すデザインパターンのことです。
これにより、データにアクセスするために使うアプリの他の部分にクリーンなAPIを提供することが可能になります。

レポジトリーはデータベース（永続性モデル、ウェブサービス、キャッシュなど）とアプリの他の部分を取り持つ役目を果たしてくれます。以下のダイアグラムはLiveDataを使っているアクティビティのような、アプリのコンポーネントがレポジトリーを経由してデータソースとどのようにやり取りしているのかを示しています。
![image](https://user-images.githubusercontent.com/96398365/183235698-1dee932a-43b3-4924-8eea-84c6da722997.png)
レポジトリーを実装するためには、レポジトリークラスを使います。レポジトリークラスはデータソースをアプリの他の部分から隔離し、データアクセス用のクリーンなAPIをアプリの他の部分に提供します。レポジトリークラスを使うことはコードの分離とアーキテクチャのために推奨されているベストプラクティスです。

### レポジトリを使う利点<br>

・レポジトリーモジュールはデータ操作を扱い、複数のバックエンドを扱えるようにしてくれます。典型的な実用アプリでは、レポジトリーはネットワークからデータを読み取るか、またはローカルデータベースにキャッシュされたデータを使うかなどを決定するためのロジックを実装しています。これにより、コードを単位化しテストしやすくできます。簡単にレポジトリーをモックアップし、コードの他の部分をテストすることができます。


キャッシング(キャッシュ)
--------------

アプリがネットワークからデータを読み取った後、端末のストレージにデータを保存することで、データをキャッシュすることができます。
後で端末がオフラインのときにデータにアクセスしたり、何度も同じデータにアクセスしたいときなどにキャッシュします。

### Roomデータベースを利用してキャッシュ<br>

アプリに Room データベースを追加して、オフライン キャッシュとして使用する。新しいネットワークリザルトを受け取ったときに、ローカルデータベースを更新し、新規コンテンツをローカルデータベースから画面に表示します。この手法によってオフラインキャッシュが常に最新であることが確認できます。また、端末がオフラインの場合でもキャッシュされたデータをローカルで読み込むことができます

![image](https://user-images.githubusercontent.com/96398365/183078096-9f259ad8-5988-430b-a1de-b63c8eb45e8d.png)

データベースのリフレッシュ
--------------

・データベースのリフレッシュとはローカルデータベースとネットワークからのデータを常に同期させるために更新したりリフレッシュしたりするプロセスのことです。このアプリでは、とてもシンプルなリフレッシュ手法を使います。レポジトリーからデータをリクエストするモジュールでローカルデータのリフレッシュを行います。この手法はもっと複雑なものがある。例えば、バックグラウンドで自動でデータをリフレッシュさせたり、ユーザーが次に使う可能性が高いデータをキャッシュさせたりなど。

WorkManager
--------------

WorkManagerはAndroidアーキテクチャコンポーネントの一つであり、Android Jetpackの一部です。WorkManagerは延期可能かつ実行の保証が要求されるバックグラウンド作業用に使われます。<br>

参考URL：https://developer.android.com/topic/libraries/architecture/workmanager<br>
        https://developer.android.com/jetpack/androidx/releases/work<br>

  ・延期可能とは、その作業が即座に実行される必要がないということを意味しています。例として、バックグラウンドで分析データをサーバーに送ったり、データベースと同期するといったものは延期可能な作業と言えます。<br>
  ・実行が保障されるとは、アプリが終了したり、端末が再起動してもタスクが実行されるということを意味しています。<br>

WorkManagerがバックグラウンド作業を実行している間は、互換性の問題や、バッテリーおよびシステムの健全性のベストプラクティスに則ることにもなります。WorkManagerはAPI14までの下位互換性を持っています。WorkManagerは端末のAPIレベルに応じて、バックグラウンドタスクの最適なスケジューリング方法を選択します。（API23以上の場合）JobSchedulerや、AlarmManagerとBroadcastReceiverの組み合わせを使う場合もあります。<br>
![image](https://user-images.githubusercontent.com/96398365/183336207-9c7fb595-c739-4c33-95bc-716b1a5f2dd2.png)

またWorkManagerではバックグラウンドタスクが動作するときの基準を設定できます。例えば、バッテリー状態やネットワーク状態、充電状態が特定の基準を満たしたときにのみ、あるタスクを実行させたいときなどです。制約の設定方法↓<br>
参考URL：https://developer.android.com/topic/libraries/architecture/workmanager/how-to/define-work#work-constraints
